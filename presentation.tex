\documentclass{beamer}
\usepackage{amsmath}
\usepackage{bm}
\usepackage[utf8]{inputenc}
\usepackage{braket}
\usepackage{listings}
\usetheme{Copenhagen}

% listings python setting

% Default fixed font does not support bold face
\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{12} % for bold
\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{12}  % for normal

% Custom colors
\usepackage{color}
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}

\usepackage{listings}

% Python style for highlighting
\newcommand\pythonstyle{\lstset{
language=Python,
basicstyle=\ttm,
morekeywords={self},              % Add keywords here
keywordstyle=\ttb\color{deepblue},
emph={MyClass,__init__},          % Custom highlighting
emphstyle=\ttb\color{deepred},    % Custom highlighting style
stringstyle=\color{deepgreen},
frame=single,                         % Any extra options here
breaklines=true,
postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
showstringspaces=false
}}


% Python environment
\lstnewenvironment{python}[1][]
{
\pythonstyle
\lstset{#1}
}
{}

% Python for external files
\newcommand\pythonexternal[2][]{{
\pythonstyle
\lstinputlisting[#1]{#2}}}

% Python for inline
\newcommand\pythoninline[1]{{\pythonstyle\lstinline!#1!}}

% end python settings

\title{Programming project 3: Restricted Hartree-Fock}

\author{Van der Stichelen Ruben, Wieme Xander}

\institute{Ghent University}

\date{March 10 2021}
\begin{document}
\begin{frame}
    \titlepage
\end{frame}

\begin{frame}
    \frametitle{contents}
    \tableofcontents
\end{frame}

\section{Why?}
\label{sec:why}
\begin{frame}
    \frametitle{Why?}
    \begin{itemize}
        \item Schr√∂dinger Equation
        \begin{equation*}
            \hat{\boldsymbol{H}}\Psi = E\Psi
        \end{equation*}
        \item True Hamiltonian
        \begin{equation*}
            \hat{\boldsymbol{H}} = \sum_i^N\hat{h}(i) + \frac{1}{2}\sum_i^N\sum_j^N\frac{1}{|\boldsymbol{r}_i - \boldsymbol{r}_j|} 
        \end{equation*}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{What do we need?}
    \begin{enumerate}
        \item Slater Determinant
        \begin{equation*}
            \ket{\Psi} = \frac{1}{\sqrt{N!}}\begin{vmatrix}
                \chi_1(\boldsymbol{x}_1) & \cdots & \chi_n(\boldsymbol{x}_1) \\
                \cdots & \cdots & \cdots \\
                \chi_1(\boldsymbol{x}_n) & \cdots & \chi_n(\boldsymbol{x}_n)\\
            \end{vmatrix}
        \end{equation*}
        \item spin-orbitals
        \begin{equation*}
            \chi_i(\boldsymbol{x_j}) = \psi_i(\boldsymbol{r}_j)\gamma(\boldsymbol{\omega}_j)
        \end{equation*}
    \end{enumerate}
\end{frame}

\begin{frame}
    \begin{itemize}
        \item Expectation value
        \begin{multline*}
            \bra{\Psi}\hat{\boldsymbol{H}}\ket{\Psi} = \sum_i^N\bra{\chi_i}\hat{h}(1)\ket{\chi_i} \\
            + \frac{1}{2}\sum_i^N\sum_j^N\left(\int\chi_i^*(1)\chi_i(1)\frac{1}{|\boldsymbol{r}_i- \boldsymbol{r}_j|}\chi_j^*(2)\chi_j(2)d1d2 \right.\\
             \left. - \int\chi_i^*(1)\chi_j(1)\frac{1}{|\boldsymbol{r}_i - \boldsymbol{r}_j|}\chi_j^*(2)\chi_i(2)d1d2\right)
        \end{multline*}
    \end{itemize}
\end{frame}

\begin{frame}
    \begin{itemize}
        \item Energy is stationary
        \begin{equation*}
            E(\chi_i + \delta\chi_i) - E(\chi_i) =\delta E = 0
        \end{equation*}
        \item Correct for non-orthonormality
        \begin{equation*}
            L = E - \sum_{ij}\epsilon_{ij}(\braket{\chi_i|\chi_j} - \delta_{ij})
        \end{equation*}
        
        \begin{equation*}
            \delta L = \sum_i\bra{\delta\chi_i}\hat{h}(1) + \sum_j(\hat{J_j} - \hat{K_j})\ket{\chi_i} -  \sum_{ij}\epsilon_{ij}\braket{\delta\chi_i|\chi_j} + CC = 0
        \end{equation*}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Some Helpfull Operators}
    \begin{itemize}
        \item Coulomb operator
        \begin{equation*}
            \bra{\chi_i}\hat{J}_j\ket{\chi_i} = \int\chi_i^*(1)\chi_j^*(2)\frac{1}{|\boldsymbol{r}_i- \boldsymbol{r}_j|}\chi_i(1)\chi_j(2)d1d2
         \end{equation*}
        \item exchange operator
        \begin{equation*}
            \bra{\chi_i}\hat{K}_j\ket{\chi_i} = \int\chi_i^*(1)\chi_j(1)\frac{1}{|\boldsymbol{r}_i - \boldsymbol{r}_j|}\chi_j^*(2)\chi_i(2)d1d2)
        \end{equation*}
    \end{itemize}
\end{frame}

\begin{frame}
    \begin{itemize}
        \item Condition
        \begin{equation*}
            \left(\hat{h}(1) + \sum_j(\hat{J_j} - \hat{K_j})\right)\chi_i = \sum_{j}\epsilon_{ij}\chi_j
        \end{equation*}
        \item Hartree-Fock Equation
        \begin{equation*}
            \hat{f}(1)\chi_i = \epsilon_i\chi_i
        \end{equation*}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Spin elimination}
    \begin{itemize}
        \item No interaction with spin $\rightarrow$ remove it
        \item Example: $\alpha$-Spin
        \begin{equation*}
            \bra{\alpha}\hat{f}(1)\ket{\psi_i(\boldsymbol{r}_1)\alpha} = \epsilon_i\psi_i(\boldsymbol{r}_1)
        \end{equation*}
        \item Exchange operator?
        \begin{equation*}
            \hat{K}_j\ket{\psi_i(1)\alpha(1)} = \int\chi_j(1)\frac{1}{|\boldsymbol{r}_i - \boldsymbol{r}_j|}\chi_j^*(2)\psi_i(2)\alpha(2)d1d2)
        \end{equation*}
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Restricted Hartree Fock}
    \begin{itemize}
        \item Only paired electrons (Pauli principle)
        \item In the same orbitals
        \begin{equation*}
            \hat{f}(1) = \hat{h}(1) + 2\sum_i^{N/2}\hat{J}_i - \sum_i^{N/2}\hat{K}_i
        \end{equation*}
    \end{itemize}
\end{frame}
\section{How?}
\label{sec:how}
\begin{frame}[fragile]
    \frametitle{How?}
    \begin{python}
class Molecule:
    def __init__(self, geom_file):
        if "pubchem" in geom_file:
            self.id = psi4.geometry(geom_file)
        else:
            input = open(filename, 'r').readlines()
            data = ""
            for i, row in enumerate(input[1:]):
                Z, x, y, z = row.split()
                data += f"{int(float(Z))} {x} {y} {z}\n"
            ...       
    \end{python}
\end{frame}

\begin{frame}[fragile]
    \begin{python}
        ...
        data += "units bohr"
        self.id = psi4.geometry(data)
        self.id.update_geometry()
        self.wfn =  psi4.core.Wavefunction.build(self.id, psi4.core.get_global_option('basis'))
        self.basis = self.wfn.basisset()
        self.integrals = psi4.core.MintsHelper(self.basis)
        self.occupied = self.wfn.nalpha()  # only works for closed shell systems
        self.guessMatrix = "empty"
    \end{python}
    
\end{frame}

\begin{frame}[fragile]
    \begin{python}
def displayNucRep(self):
    """
    Will calculate the nuclear repulsion
    """
    return self.id.nuclear_repulsion_energy()
    \end{python}
    
\end{frame}

\begin{frame}[fragile]
    \begin{python}
def one_electron_integrals(self):
        """
        Will calculate the one-electron integrals
        """
        self.S = self.integrals.ao_overlap().np
        self.T = self.integrals.ao_kinetic().np
        self.V = self.integrals.ao_potential().np
        self.H_core = self.T + self.V 
    \end{python}


\end{frame}

\begin{frame}[fragile]
    \begin{python}
def ElectronRepulsion(self):
        """
        Will calculate the interelectronic repulsion as a np array (4D array)
        """
        self.tei = self.integrals.ao_eri().np
    \end{python}
    
\end{frame}

\end{document}